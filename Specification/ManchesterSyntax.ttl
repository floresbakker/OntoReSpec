prefix dcm: <http://purl.org/dc/dcmitype/>
prefix dct: <http://purl.org/dc/terms/>
prefix foaf: <http://xmlns.com/foaf/0.1/>
prefix owl:    <http://www.w3.org/2002/07/owl#>
prefix prov:   <http://www.w3.org/ns/prov#>
prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfa:   <http://www.w3.org/ns/rdfa#>
prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#>
prefix sh:     <http://www.w3.org/ns/shacl#>
prefix skos:   <http://www.w3.org/2004/02/skos/core#>
prefix status: <http://purl.org/adms/status/>
prefix vann:   <http://purl.org/vocab/vann/>
prefix void:   <http://rdfs.org/ns/void#>
prefix xsd:    <http://www.w3.org/2001/XMLSchema#>
 
prefix decl:       <https://data.rijksfinancien.nl/manchester/id/decl/>
prefix function:   <https://data.rijksfinancien.nl/manchester/model/function/>
prefix graph:      <https://data.rijksfinancien.nl/manchester/graph/>
prefix list:       <https://data.rijksfinancien.nl/manchester/model/list/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix parameter:  <https://data.rijksfinancien.nl/manchester/model/parameter/>
prefix respec:     <https://respec.org/ontorespec/model/def/> 
prefix rule:       <https://data.rijksfinancien.nl/manchester/model/rule/>
prefix shp:        <https://data.rijksfinancien.nl/manchester/model/shp/>
prefix standard:   <https://data.rijksfinancien.nl/manchester/id/standard/>
prefix target:     <https://data.rijksfinancien.nl/manchester/model/target/>

manchester: {
  manchester:
    a
      owl:Ontology,
      void:Dataset;
    dct:conformsTo 'https://www.w3.org/TR/owl2-manchester-syntax/'^^xsd:anyURI;
    dct:created '2023-07-19'^^xsd:date;
    dct:creator
      'Flores Bakker',
      'Wouter Beek';
    dct:description '''The RDF-based Manchester Syntax Vocabulary can express OWL ontologies into Manchester Syntax. Manchester Syntax is a human-readable and compact syntax used to represent knowledge in the Web Ontology Language (OWL), which is a semantic web language based on RDF and used for defining and sharing ontologies. Manchester Syntax is designed to be human-readable and concise, making it easier for users to create and understand OWL ontologies. It provides an alternative to the more verbose syntax of OWL itself. '''@en;
    dct:abstract '''The RDF-based Manchester Syntax Vocabulary can express OWL ontologies into Manchester Syntax. Manchester Syntax is a human-readable and compact syntax used to represent knowledge in the Web Ontology Language (OWL), which is a semantic web language based on RDF and used for defining and sharing ontologies. Manchester Syntax is designed to be human-readable and concise, making it easier for users to create and understand OWL ontologies. It provides an alternative to the more verbose syntax of OWL itself.  '''@en;
    dct:language 'iso639-1:en';
    dct:license 'http://creativecommons.org/licenses/by/4.0'^^xsd:anyURI;
    dct:publisher <https://www.w3.org/community/manchestersyntax/>;
    dct:source <https://github.com/floresbakker/manchestersyntax/>;
    dct:subject 'Manchester Syntax'@en;
    dct:title 'Manchester Syntax Vocabulary'@en;
    foaf:homepage 'https://www.w3.org/community/manchestersyntax/'^^xsd:anyURI;
    owl:imports
      dct:,
      owl:,
      prov:,
      rdf:,
      rdfs:,
      sh:,
      skos:;
    sh:declare
      decl:dcm,
      decl:dct,
      decl:foaf,
      decl:owl,
      decl:prov,
      decl:rdf,
      decl:rdfs,
      decl:sh,
      decl:skos,
      decl:status,
      decl:vann,
      decl:void,
      decl:xsd;      
    owl:versionInfo '0.1.0';
    owl:versionIRI <https://github.com/floresbakker/manchestersyntax/tree/main>;
    manchester:iriPattern """^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$""";    
    vann:preferredNamespacePrefix 'manchester';
    vann:preferredNamespaceUri 'https://data.rijksfinancien.nl/manchestersyntax/model/def/'^^xsd:anyURI;
    void:subSet graph:model;
    void:uriRegexPattern '^https://data.rijksfinancien.nl/manchestersyntax/def/';
    void:uriSpace 'https://data.rijksfinancien.nl/manchestersyntax/model/def/'^^xsd:anyURI.

  decl:dcm
    sh:prefix "dcm";
    sh:namespace "http://purl.org/dc/dcmitype/"^^xsd:anyURI.

  decl:dct
    sh:prefix "dct";
    sh:namespace "http://purl.org/dc/terms/"^^xsd:anyURI.
    
  decl:foaf
    sh:prefix "foaf";
    sh:namespace "http://xmlns.com/foaf/0.1/"^^xsd:anyURI.

  decl:owl
    sh:prefix "owl";
    sh:namespace "http://www.w3.org/2002/07/owl#"^^xsd:anyURI.
    
  decl:prov
    sh:prefix "prov";
    sh:namespace "http://www.w3.org/ns/prov#"^^xsd:anyURI.

  decl:rdf
    sh:prefix "rdf";
    sh:namespace "http://www.w3.org/1999/02/22-rdf-syntax-ns#"^^xsd:anyURI.

  decl:rdfs
    sh:prefix "rdfs";
    sh:namespace "http://www.w3.org/2000/01/rdf-schema#"^^xsd:anyURI.

  decl:sh
    sh:prefix "sh";
    sh:namespace "http://www.w3.org/ns/shacl#"^^xsd:anyURI.

  decl:skos
    sh:prefix "skos";
    sh:namespace "http://www.w3.org/2004/02/skos/core#"^^xsd:anyURI.
    
  decl:status
    sh:prefix "status";
    sh:namespace "http://purl.org/adms/status/"^^xsd:anyURI.    

  decl:vann
    sh:prefix "vann";
    sh:namespace "http://purl.org/vocab/vann/"^^xsd:anyURI.

  decl:void
    sh:prefix "void";
    sh:namespace "http://rdfs.org/ns/void#"^^xsd:anyURI.
    
  decl:xsd
    sh:prefix "xsd";
    sh:namespace "http://www.w3.org/2001/XMLSchema#"^^xsd:anyURI.

    
  standard:manchestersyntax
    a dct:Standard;
    dct:created '2023-07-19'^^xsd:date;
    dct:source 'https://www.w3.org/TR/owl2-manchester-syntax'^^xsd:anyURI;
    skos:prefLabel 'Manchester Syntax'@en.

### OWL Class

 shp:SerializableOwlClass
    a sh:NodeShape;
    sh:rule rule:SerializeOwlClass;
    sh:target target:SerializableOwlClass;
    skos:prefLabel 'Serializable owl class shape'@en.

  target:SerializableOwlClass
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {
  # Any OWL or RDFS class that is not further expressed in class expression
  
  {$this a owl:Class.}
  UNION
  {$this a rdfs:Class.}
  
  filter not exists {
    $this rdfs:subClassOf []
  }
  filter not exists {
    $this owl:equivalentClass []
  }
  filter not exists {
    $this owl:unionOf []
  }
  filter not exists {
    $this owl:intersectionOf []
  }
  filter not exists {
    $this owl:complementOf []
  }
  filter not exists {
    $this owl:oneOf []
  }
  
  # The OWL class must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeOwlClass
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for an OWL Class.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl class'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax 'CLASS';
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous class",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
  
} 
'''.


### OWL Restriction

shp:SerializableOwlRestriction_AllValuesFrom
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_AllValuesFrom;
    sh:target target:SerializableOwlRestriction_AllValuesFrom;
    skos:prefLabel 'Serializable owl restriction owl:allValuesFrom shape'@en.

  target:SerializableOwlRestriction_AllValuesFrom
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:allValuesFrom [].

  filter not exists {
    $this manchester:syntax "ONLY"
   }
   
  minus {
    $this owl:allValuesFrom ?someClass.
    ?someClass ?anyPredicate [].
      filter not exists {
       ?someClass manchester:label []
    }
  }
  
  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
  }
 }
}
 
 '''.

  rule:SerializeOwlRestriction_AllValuesFrom
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:allValuesFrom.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:allValuesFrom'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "ONLY";
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.

} where {

  $this owl:allValuesFrom ?someClass;
        owl:onProperty ?someProperty.
  
  # Get the labels for the class and property
  optional {?someClass manchester:label ?optionalClassLabel.}
  optional {?someProperty manchester:label ?optionalPropertyLabel.}
  bind(if(function:isIRI(?someClass), function:getPrefixedIRI(?someClass), ?unboundDummy) as ?implicitClassLabel)
  bind(coalesce(?optionalClassLabel, ?implicitClassLabel) as ?classLabel)
  bind(coalesce(?optionalPropertyLabel, function:getPrefixedIRI(?someProperty)) as ?propertyLabel)
    
  # Establish the full description of the OWL restriction class to be serialized.
  bind(concat(?propertyLabel, " only ", ?classLabel) as ?manchesterDescription)
      
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
}
'''.

shp:SerializableOwlRestriction_SomeValuesFrom
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_SomeValuesFrom;
    sh:target target:SerializableOwlRestriction_SomeValuesFrom;
    skos:prefLabel 'Serializable owl restriction owl:someValuesFrom shape'@en.

  target:SerializableOwlRestriction_SomeValuesFrom
    a sh:SPARQLTarget;
    sh:select '''

prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:someValuesFrom [].

  filter not exists {
    $this manchester:syntax 'SOME'
  }
   
  minus {
    $this owl:someValuesFrom ?someClass.
    ?someClass ?anyPredicate [].
    filter not exists {
     ?someClass manchester:label []
    }
   }
 
  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
    }
  }
}
 '''.

  rule:SerializeOwlRestriction_SomeValuesFrom
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:someValuesFrom.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:someValuesFrom'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "SOME";
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.

} where {

  $this owl:someValuesFrom ?someClass;
        owl:onProperty ?someProperty.
  
  # Get the labels for the class and property
  optional{?someClass manchester:label ?optionalClassLabel.}
  optional{?someProperty manchester:label ?optionalPropertyLabel.}
  bind(if(function:isIRI(?someClass), function:getPrefixedIRI(?someClass), ?unboundDummy) as ?implicitClassLabel)
  bind(coalesce(?optionalClassLabel, ?implicitClassLabel) as ?classLabel)
  bind(coalesce(?optionalPropertyLabel, function:getPrefixedIRI(?someProperty)) as ?propertyLabel)
  
  # Establish the full description of the OWL restriction class to be serialized.
  bind(concat(?propertyLabel, " some ", ?classLabel) as ?manchesterDescription)
    
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
}
'''.


shp:SerializableOwlRestriction_hasValue
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_hasValue;
    sh:target target:SerializableOwlRestriction_hasValue;
    skos:prefLabel 'Serializable owl restriction owl:hasValue shape'@en.

  target:SerializableOwlRestriction_hasValue
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying named individual is already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:hasValue [].

  filter not exists {
   $this manchester:syntax 'VALUE'
  }
   
  minus {
    $this owl:hasValue ?value.
    ?value ?anyPredicate [].
    filter not exists {
     ?value manchester:syntax 'INDIVIDUAL'.
    }
	filter not exists {
     ?value manchester:syntax 'CONCEPTSCHEME'.
    }
	filter not exists {
     ?value manchester:syntax 'CONCEPT'.
    }
  }
  
  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
    }
  }
 }
  '''.

  rule:SerializeOwlRestriction_hasValue
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:hasValue.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:hasValue'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "VALUE";
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.

} where {

  $this owl:hasValue ?someIndividual;
        owl:onProperty ?someProperty.
  
  # Get the labels for the individual and property
  optional
  {?someIndividual manchester:label ?optionalIndividualLabel.}
  
  bind(coalesce(?optionalIndividualLabel, if(function:isIRI(?someIndividual), function:getPrefixedIRI(?someIndividual), ?unboundDummy)) as ?individualLabel)
  
  optional
  {?someProperty manchester:label ?originalPropertyLabel.}
  bind(coalesce(?originalPropertyLabel, function:getPrefixedIRI(?someProperty)) as ?propertyLabel)
  
  # Establish the full description of the OWL restriction class to be serialized.
  bind(concat(?propertyLabel, " value ", ?individualLabel) as ?manchesterDescription)
    
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
}
  '''.

shp:SerializableOwlRestriction_cardinality
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_cardinality;
    sh:target target:SerializableOwlRestriction_cardinality;
    skos:prefLabel 'Serializable owl restriction owl:cardinality shape'@en.

  target:SerializableOwlRestriction_cardinality
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:cardinality [];
        owl:onProperty ?someProperty.
   
  filter not exists {
     $this manchester:syntax 'EXACTLY'
  }

  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
    }
  }
}
  '''.

  rule:SerializeOwlRestriction_cardinality
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:cardinality.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:cardinality'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax 'EXACTLY';
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
  
} where {

  # Get the label for the property and cardinality
  $this owl:cardinality ?n;
        owl:onProperty ?someProperty.
  optional{?someProperty manchester:label ?optionalLabelProperty.}
  bind(coalesce(?optionalLabelProperty, function:getPrefixedIRI(?someProperty)) as ?labelProperty)
  
  # Get the defining label
  bind(concat(?labelProperty, " exactly ", str(?n)) as ?manchesterDescription)
 
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
}  '''.

shp:SerializableOwlRestriction_maxCardinality
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_maxCardinality;
    sh:target target:SerializableOwlRestriction_maxCardinality;
    skos:prefLabel 'Serializable owl restriction owl:maxCardinality shape'@en.

  target:SerializableOwlRestriction_maxCardinality
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:maxCardinality [];
        owl:onProperty ?someProperty.
   
  filter not exists {
    $this manchester:syntax 'MAX'
  }

  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
    }
  }
}
  '''.

  rule:SerializeOwlRestriction_maxCardinality
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:maxCardinality.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:maxCardinality'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax 'MAX';
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
  
} where {

  # Get the label for the property and cardinality
  $this owl:maxCardinality ?n;
        owl:onProperty ?someProperty.
  optional {?someProperty manchester:label ?optionalLabelProperty.}
  bind(coalesce(?optionalLabelProperty, function:getPrefixedIRI(?someProperty)) as ?labelProperty)
  
  # Get the defining label
  bind(concat(str(?labelProperty), " max ", str(?n)) as ?manchesterDescription)
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
} 
'''.

shp:SerializableOwlRestriction_minCardinality
    a sh:NodeShape;
    sh:rule rule:SerializeOwlRestriction_minCardinality;
    sh:target target:SerializableOwlRestriction_minCardinality;
    skos:prefLabel 'Serializable owl restriction owl:minCardinality shape'@en.

  target:SerializableOwlRestriction_minCardinality
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this a owl:Restriction;
        owl:minCardinality [].
   
  filter not exists {
    $this manchester:syntax 'MIN'
  }

  minus {
    $this owl:onProperty ?someProperty.
    ?someProperty ?anyPredicate [].
    filter not exists {
      ?someProperty manchester:label []
    }
  }
}
  '''.

  rule:SerializeOwlRestriction_minCardinality
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for OWL Restriction owl:minCardinality.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl restriction owl:minCardinality'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax 'MIN';
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
  
} where {

  # Get the label for the property and cardinality
  $this owl:minCardinality ?n;
        owl:onProperty ?someProperty.
  optional{?someProperty manchester:label ?optionalLabelProperty.}
  bind(coalesce(?optionalLabelProperty, function:getPrefixedIRI(?someProperty)) as ?labelProperty)
  
  # Get the description
  bind(concat(str(?labelProperty), " min ", str(?n)) as ?manchesterDescription)
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), ?manchesterDescription, concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)

} 
'''.

shp:Serializable_subClassOf
    a sh:NodeShape;
    sh:rule rule:Serialize_subClassOf;
    sh:target target:Serializable_subClassOf;
    skos:prefLabel 'Serializable rdfs:subClassOf shape'@en.

  target:Serializable_subClassOf
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A subclass of some other, atomic or composite, class, of which the latter's underlying class expressions are already serialized to manchester syntax.
  
  $this rdfs:subClassOf [].
   
   filter not exists {
    $this manchester:syntax 'SUBCLASSOF'
   }
  
   minus {
    $this rdfs:subClassOf ?someClass.
    ?someClass ?anyPredicate [].
    filter not exists {
     ?someClass manchester:label []
    }
   }
  }
  '''.

  rule:Serialize_subClassOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for rdfs:subClassOf classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for rdfs:subClassOf classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the class to be serialized.
  $this manchester:syntax 'SUBCLASSOF';
        manchester:type 'CLASS';
        manchester:subClassOf ?subClassOf;
        manchester:label ?manchesterLabel.

} where {
  
  $this rdfs:subClassOf ?superClass.
  optional{?superClass manchester:label ?optionalManchesterDescription.}
  bind(if(function:isBlank(?superClass), ?unboundDummy, function:getPrefixedIRI(?superClass)) as ?implicitClassLabel)
  bind(coalesce(?optionalManchesterDescription, ?implicitClassLabel) as ?manchesterDescription)
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax 'subclass' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat("SubClassOf: ",?manchesterDescription), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?subClassOf)
  }
'''.

shp:Serializable_equivalentClass
    a sh:NodeShape;
    sh:rule rule:Serialize_equivalentClass;
    sh:target target:Serializable_equivalentClass;
    skos:prefLabel 'Serializable owl:equivalentClass shape'@en.

  target:Serializable_equivalentClass
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # An equivalent class of some other class, of which the latter's underlying class expressions are already serialized to manchester syntax.
  
  $this owl:equivalentClass [].
  
  filter not exists {
    $this manchester:syntax 'EQUIVALENTTO'
   }
  
  minus {
    $this owl:equivalentClass ?equivalentClass.
    ?equivalentClass ?anyPredicate [].
    filter not exists {
     ?equivalentClass manchester:label []
    }
   }
  }
  '''.

  rule:Serialize_equivalentClass
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for owl:equivalentClass classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:equivalentClass classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the class to be serialized.
  
  $this manchester:syntax 'EQUIVALENTTO';
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo. 

} where {

  $this owl:equivalentClass ?equivalentClass.
  optional {?equivalentClass manchester:label ?optionalManchesterDescription.}
  bind(if(function:isIRI(?equivalentClass), function:getPrefixedIRI(?equivalentClass), ?unboundDummy) as ?implicitClassLabel)
  bind(coalesce(?optionalManchesterDescription, ?implicitClassLabel) as ?manchesterDescription)
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax 'EquivalentTo' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat("EquivalentTo: ",?manchesterDescription), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo)
  
}
'''.

shp:Serializable_unionOf
    a sh:NodeShape;
    sh:rule rule:Serialize_unionOf;
    sh:target target:Serializable_unionOf;
    skos:prefLabel 'Serializable owl:unionOf shape'@en.

  target:Serializable_unionOf
    a sh:SPARQLTarget;
    sh:select '''

prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this owl:unionOf [].
  
  filter not exists {
    $this manchester:syntax "OR"
   }
   
  minus {
    $this owl:unionOf/rdf:rest*/rdf:first ?someClass.
    ?someClass ?anyPredicate [].
    filter not exists {
     ?someClass manchester:label []
    }
  }
 }
  '''.

  rule:Serialize_unionOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for owl:unionOf classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:unionOf classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this  manchester:syntax "OR";
         manchester:type 'CLASS';
         manchester:label ?manchesterLabel;
         manchester:equivalentTo ?equivalentTo.
        
} where {

  {SELECT (GROUP_concat(?label;SEPARATOR=' or ') AS ?manchesterDescription) WHERE {
  $this owl:unionOf/rdf:rest*/rdf:first ?listItem.
  
  # Add label
  optional {?listItem manchester:label ?optionalLabel.}
  bind(coalesce(?optionalLabel, if(function:isBlank(?listItem),?unboundDummy, function:getPrefixedIRI(?listItem))) as ?label)
   }
  }

  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax ' or ' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat('(', ?manchesterDescription, ')'), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo) 
  
}
'''.

shp:Serializable_intersectionOf
    a sh:NodeShape;
    sh:rule rule:Serialize_intersectionOf;
    sh:target target:Serializable_intersectionOf;
    skos:prefLabel 'Serializable owl:intersectionOf shape'@en.

  target:Serializable_intersectionOf
    a sh:SPARQLTarget;
    sh:select '''

prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A class that is the intersection of other classes for which the latter's underlying class expressions are already serialized to manchester syntax or for which the latter's underlying class expressions involve external classes not defined in this ontology.
  
  $this owl:intersectionOf [].
  
  filter not exists {
    $this manchester:syntax "AND"
   }
   
  minus {
    $this owl:intersectionOf/rdf:rest*/rdf:first ?someClass.
    ?someClass ?somePredicate [].
    filter not exists {
     ?someClass manchester:syntax [].
    }
  }
 }
  '''.

  rule:Serialize_intersectionOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for owl:intersectionOf classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:intersectionOf classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "AND"; 
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
        
} where {

  {select (group_concat(?label;separator=' and ') as ?manchesterDescription) where {
  $this owl:intersectionOf/rdf:rest*/rdf:first ?listItem.
  
  optional {?listItem manchester:label ?optionalLabel.}
  bind(coalesce(?optionalLabel, if(function:isBlank(?listItem),?unboundDummy, function:getPrefixedIRI(?listItem))) as ?label)
   } 
  }
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax ' and ' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat('(', ?manchesterDescription, ')'), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo) 

}
'''.


shp:Serializable_oneOf
    a sh:NodeShape;
    sh:rule rule:Serialize_oneOf;
    sh:target target:Serializable_oneOf;
    skos:prefLabel 'Serializable owl:oneOf shape'@en.

  target:Serializable_oneOf
    a sh:SPARQLTarget;
    sh:select '''

prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A OWL class restriction for which the underlying class expressions are already serialized to manchester syntax
  
  $this owl:oneOf [].
  
  filter not exists {
    $this manchester:syntax "{}"
   }
   
  minus {
    $this owl:oneOf/rdf:rest*/rdf:first ?someIndividual.
    filter not exists {
     ?someIndividual manchester:label []
    }
  }
 }
  '''.

  rule:Serialize_oneOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for owl:oneOf classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:oneOf classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "{}";
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
  
} where {

  {select (group_concat(?label;separator=' ') as ?individualLabels) where {
  $this owl:oneOf/rdf:rest*/rdf:first ?listItem.
  
  optional {?listItem manchester:label ?optionalLabel.}
  bind(coalesce(?optionalLabel, if(function:isBlank(?listItem),?unboundDummy, function:getPrefixedIRI(?listItem))) as ?label)
   } 
  }

  bind(concat("{", ?individualLabels, "}") as ?manchesterDescription)

  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax ' {} ' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat('(', ?manchesterDescription, ')'), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo) 
}
'''.

shp:Serializable_complementOf
    a sh:NodeShape;
    sh:rule rule:Serialize_complementOf;
    sh:target target:Serializable_complementOf;
    skos:prefLabel 'Serializable owl:complementOf shape'@en.

  target:Serializable_complementOf
    a sh:SPARQLTarget;
    sh:select '''

prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A class that is the complement of some other class, of which the latter's underlying class expressions are already serialized to manchester syntax.
  
  $this owl:complementOf [].
  
  filter not exists {
    $this manchester:syntax "NOT"
   }
   
  minus {
    $this owl:complementOf ?someClass.
    ?someClass ?anyPredicate [].
    filter not exists {
     ?someClass manchester:label []
    }
   }
  }
  '''.

  rule:Serialize_complementOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for owl:complementOf classes.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:complementOf classes.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL class to be serialized.
  
  $this manchester:syntax "NOT";
        manchester:type 'CLASS';
        manchester:label ?manchesterLabel;
        manchester:equivalentTo ?equivalentTo.
       
} where {

  $this owl:complementOf ?someClass.
  optional {?someClass manchester:label ?optionalExplicitDefinition.}
  bind(coalesce(?optionalExplicitDefinition, if(function:isIRI(?someClass), function:getPrefixedIRI(?someClass), ?unboundDummy)) as ?explicitDefinition)
  
  # Get the label of the class to be serialized.
  bind(concat("not ", str(coalesce(?explicitDefinition, ?implicitDefinition))) as ?manchesterDescription)
  
  # Establish the label for the owl class. If a blank node, then use the description of the class als label, including manchester syntax 'not ' notation. If an IRI, then use the preferred label.
  bind(if(function:isBlank($this), concat('(', ?manchesterDescription, ')'), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
  # If the class is explicitly defined in the ontology with a IRI, then add the definition to it. If the class is a blank node, do not bother.
  bind(if(function:isBlank($this), ?unboundDummy, ?manchesterDescription) as ?equivalentTo) 
  } 
'''.

shp:Serializable_RDF_Property
    a sh:NodeShape;
    sh:rule rule:Serialize_RDF_Property;
    sh:target target:Serialize_RDF_Property;
    skos:prefLabel 'Serializable rdf:Property shape'@en.

  target:Serialize_RDF_Property
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A RDF property for which underlying class expressions are already serialized to manchester syntax, but which does not have subPropertyOf or equivalentProperty relations.
  
  $this rdf:type rdf:Property.
  filter not exists {
  $this manchester:syntax 'PROPERTY'}
   
  minus {
    $this rdfs:domain ?someDomainClass.
    ?someDomainClass ?anyPredicate [].
    filter not exists {
     ?someDomainClass manchester:label []
    }
  }
  
  minus {
    $this rdfs:range ?someRangeClass.
    ?someRangeClass ?anyPredicate [].
    filter not exists {
     ?someRangeClass manchester:label []
   }
  }
 }
  '''.


  rule:Serialize_RDF_Property
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for the rdfs:domain and rdfs:range of a rdf:Property.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for rdf:Property.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL property to be serialized.
  
  $this manchester:syntax 'PROPERTY';
        manchester:label ?manchesterLabel;
        manchester:domain ?manchesterDomain;
        manchester:range ?manchesterRange.
        
} where {

  # Label of RDF property
  
  bind(concat("[=",function:getPrefixedIRI($this),"=]") as ?manchesterLabel)
  
  # Domain
  optional
  {
  $this rdfs:domain ?domainClass.
  bind(if(function:isBlank(?domainClass), ?unboundDummy, function:getPrefixedIRI(?domainClass)) as ?implicitDomain)
  }
  
  optional
  {
  $this rdfs:domain ?domainClass.
  ?domainClass manchester:label ?explicitDomain.
  } 
  
  bind(coalesce(?explicitDomain, ?implicitDomain) as ?manchesterDomain)
  
  # Range 
  optional
  {
  $this rdfs:range ?rangeClass.
  bind(if(function:isBlank(?rangeClass), ?unboundDummy, function:getPrefixedIRI(?rangeClass)) as ?implicitRange)
  }
  
  optional
  {
  $this rdfs:range ?rangeClass.
  ?rangeClass manchester:label ?explicitRange.
  }
  
  bind(coalesce(?explicitRange, ?implicitRange) as ?manchesterRange)
  
}  
'''.

shp:Serializable_datatypeProperty
    a sh:NodeShape;
    sh:rule rule:Serialize_datatypeProperty;
    sh:target target:Serialize_datatypeProperty;
    skos:prefLabel 'Serializable owl:DatatypeProperty shape'@en.

  target:Serialize_datatypeProperty
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A datatype property for which underlying class expressions are already serialized to manchester syntax, but which does not have subPropertyOf or equivalentProperty relations.
  
  $this rdf:type owl:DatatypeProperty.
  filter not exists {
  $this manchester:syntax 'DATATYPEPROPERTY'}
   
  minus {
    $this rdfs:domain ?someDomainClass.
    ?someDomainClass ?anyPredicate [].
    filter not exists {
     ?someDomainClass manchester:label []
   }
  }
 }
  '''.


  rule:Serialize_datatypeProperty
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for the rdfs:domain of an owl:DatatypeProperty.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:DatatypeProperty.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>


construct {

  # create the manchester syntax for the OWL property to be serialized.
  
  $this manchester:syntax 'DATATYPEPROPERTY';
        manchester:label ?manchesterLabel;
        manchester:domain ?manchesterDomain;
        manchester:range ?manchesterRange.
        
} where {

  # Label of datatype property
  
  bind(concat("[=",function:getPrefixedIRI($this),"=]") as ?manchesterLabel)
  
 # Domain
  optional
  {$this rdfs:domain ?domainClass.
  bind(if(function:isBlank(?domainClass), ?unboundDummy, function:getPrefixedIRI(?domainClass)) as ?implicitDomain)
  }
  
  optional
  {$this rdfs:domain ?domainClass.
  ?domainClass manchester:label ?explicitDomain.
  }
  
  bind(coalesce(?explicitDomain, ?implicitDomain) as ?manchesterDomain)
  
  # Range 
  optional
  {$this rdfs:range ?rangeDatatype.
  bind(function:getPrefixedIRI(?rangeDatatype) as ?manchesterRange)
  }
}  
'''.

shp:Serializable_objectProperty
    a sh:NodeShape;
    sh:rule rule:Serialize_objectProperty;
    sh:target target:Serialize_objectProperty;
    skos:prefLabel 'Serializable owl:ObjectProperty shape'@en.

  target:Serialize_objectProperty
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # An object property for which underlying class expressions are already serialized to manchester syntax, but which does not have subPropertyOf or equivalentProperty relations.
  
  $this rdf:type owl:ObjectProperty.
  filter not exists {
  $this manchester:syntax 'OBJECTPROPERTY'}
   
  minus {
    $this rdfs:domain ?someDomainClass.
    ?someDomainClass ?anyPredicate [].
    filter not exists {
     ?someDomainClass manchester:label []
    }
  }
  
  minus {
    $this rdfs:range ?someRangeClass.
    ?someRangeClass ?anyPredicate [].
    filter not exists {
     ?someRangeClass manchester:label []
   }
  }
 }
  '''.


  rule:Serialize_objectProperty
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for the rdfs:domain and rdfs:range of an owl:ObjectProperty.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:ObjectProperty.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

construct {

  # create the manchester syntax for the OWL property to be serialized.
  
  $this manchester:syntax 'OBJECTPROPERTY';
        manchester:label ?manchesterLabel;
        manchester:domain ?manchesterDomain;
        manchester:range ?manchesterRange.

} where {

  # Label of object property
  bind(concat("[=",function:getPrefixedIRI($this),"=]") as ?manchesterLabel)
  
  # Domain
  optional
   {
   $this rdfs:domain ?domainClass.
   bind(if(function:isBlank(?domainClass), ?unboundDummy, function:getPrefixedIRI(?domainClass)) as ?implicitDomain)
   }
  
  optional
   {
   $this rdfs:domain ?domainClass.
   ?domainClass manchester:label ?explicitDomain.
   }
 
  bind(coalesce(?explicitDomain, ?implicitDomain) as ?manchesterDomain)
  
  # Range 
  optional
   {
   $this rdfs:range ?rangeClass.
   bind(if(function:isBlank(?rangeClass), ?unboundDummy, function:getPrefixedIRI(?rangeClass)) as ?implicitRange)
   }

  optional 
   {
   $this rdfs:range ?rangeClass.
   ?rangeClass manchester:label ?explicitRange.
   }

   bind(coalesce(?explicitRange, ?implicitRange) as ?manchesterRange)
  
}    
'''.

shp:Serializable_subPropertyOf
    a sh:NodeShape;
    sh:rule rule:Serialize_subPropertyOf;
    sh:target target:Serialize_subPropertyOf;
    skos:prefLabel 'Serializable owl:DatatypeProperty shape with a rdfs:subPropertyOf relation.'@en.

  target:Serialize_subPropertyOf
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A datatype or object property for which exists some subproperty relation.
  
  # superproperty that is described in terms of manchester syntax.
  {
    $this rdfs:subPropertyOf ?someProperty.
    ?someProperty manchester:label []
    filter NOT EXISTS {
      $this manchester:syntax 'SUBPROPERTY'.
    }
    
  }

  UNION
  # superproperty that is not further described in the ontology, hence for which is there no manchester syntax known.
  {
    $this rdfs:subPropertyOf ?someProperty.
    filter NOT EXISTS {
      $this manchester:syntax 'SUBPROPERTY'.
    }    
    filter NOT EXISTS {
      ?someProperty ?anyPredicate [].
    }
  }
}
'''.

  rule:Serialize_subPropertyOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax for an owl:DatatypeProperty with a subPropertyOf relation.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:DatatypeProperty with a subPropertyOf relation.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>


construct {

  # create the manchester syntax for the OWL property to be serialized.
  
  $this manchester:syntax 'SUBPROPERTY';
        manchester:subPropertyOf ?manchesterSuperProperty.		
  
} where {

  $this rdfs:subPropertyOf ?superProperty.
  
  optional
  {?superProperty manchester:label ?optionalManchesterSuperProperty.}
  
  bind(coalesce(?optionalManchesterSuperProperty, function:getPrefixedIRI(?superProperty)) as ?manchesterSuperProperty)
  
}  
'''.

shp:Serializable_equivalentProperty
    a sh:NodeShape;
    sh:rule rule:Serialize_equivalentProperty;
    sh:target target:Serialize_equivalentProperty;
    skos:prefLabel 'Serializable owl:DatatypeProperty shape with a owl:equivalentProperty relation.'@en.

  target:Serialize_equivalentProperty
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # A datatype or object property for which exists some equivalent property relation.
  $this owl:equivalentProperty ?someProperty.
  
  filter not exists {
  $this manchester:equivalentProperty []}
  
  minus {
  $this owl:equivalentProperty ?someProperty.
  ?someProperty ?anyPredicate [].
    filter not exists 
      {
       ?someProperty manchester:label []
      }   
  }
}
'''.

  rule:Serialize_equivalentProperty
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax for an owl:DatatypeProperty with an equivalentProperty relation.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:DatatypeProperty with an equivalentProperty relation.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>


construct {

  # create the manchester syntax for the OWL property to be serialized.
  
  $this manchester:syntax 'EQUIVALENTPROPERTY';
        manchester:equivalentProperty ?manchesterEquivalentProperty.
  
} where {

  $this owl:equivalentProperty ?equivalentProperty.
  
  optional
  {?equivalentProperty manchester:label ?optionalManchesterEquivalentProperty.}
  
  bind(coalesce(?optionalManchesterEquivalentProperty, function:getPrefixedIRI(?equivalentProperty)) as ?manchesterEquivalentProperty)
 
}  
'''.

shp:Serializable_inverseOf
    a sh:NodeShape;
    sh:rule rule:Serialize_inverseOf;
    sh:target target:Serialize_inverseOf;
    skos:prefLabel 'Serializable object property shape with an owl:inverseOf relation.'@en.

  target:Serialize_inverseOf
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>

select $this {

  # An object property for which exists some inverseOf relation.
  
  # inverse property that is described in terms of manchester syntax.
  {
    $this owl:inverseOf ?someProperty.
    ?someProperty manchester:label []
    filter NOT EXISTS {
      $this manchester:syntax 'INVERSEOF'.
    }
    
  }

  UNION
  # inverse property that is not further described in the ontology, hence for which is there no manchester syntax known.
  {
    $this owl:inverseOf ?someProperty.
    filter NOT EXISTS {
      $this manchester:syntax 'INVERSEOF'.
    }    
    filter NOT EXISTS {
      ?someProperty ?anyPredicate [].
    }
  }
}
'''.

  rule:Serialize_inverseOf
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax for an owl:ObjectProperty with an inverseOf relation.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for owl:ObjectProperty with an inverseOf relation.'@en;
    sh:construct '''

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>


construct {

  # create the manchester syntax for the inverseOf property to be serialized.
  
  $this manchester:syntax 'INVERSEOF';
        manchester:label ?manchesterLabel;
        manchester:inverseOf ?manchesterInverseProperty.		
  
} where {

  $this owl:inverseOf ?inverseProperty.
  
  optional
  {?inverseProperty manchester:label ?optionalManchesterInverseProperty.}
  
  bind(concat("inverse of ", if(function:isIRI(?inverseProperty), function:getPrefixedIRI(?inverseProperty), ?optionalManchesterInverseProperty)) as ?manchesterDescription) 
  bind(coalesce(?optionalManchesterInverseProperty, function:getPrefixedIRI(?inverseProperty)) as ?manchesterInverseProperty)
  bind(if(function:isBlank($this), concat('(', ?manchesterDescription, ')'), concat("[=",function:getPrefixedIRI($this), "=]")) as ?manchesterLabel)
  
}  
'''.

shp:Serializable_namedIndividual
    a sh:NodeShape;
    sh:rule rule:Serialize_namedIndividual;
    sh:target target:Serialize_namedIndividual;
    skos:prefLabel 'Serializable Named Individual shape.'@en.

target:Serialize_namedIndividual
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix respec: <https://respec.org/ontorespec/model/def/>
prefix sh: <http://www.w3.org/ns/shacl#>
prefix skos: <http://www.w3.org/2004/02/skos/core#>

select $this {

  # A named individual for which underlying class expressions are already serialized to manchester syntax.

  {
    $this rdf:type ?class.
    filter not exists {
      $this manchester:syntax 'INDIVIDUAL'
    }
    ?class manchester:label ?classDescription.
  }
  union
  {
    $this rdf:type ?class.
    filter not exists {
      $this manchester:syntax 'INDIVIDUAL'
    }
    filter not exists {
      ?class ?predicate []
    }
  }

  # Make sure to only query instantiations of classes, and not individual ontologies, properties, annotations, SHACL shapes, SKOS concepts, nor classes themselves.

  filter not exists {
    $this rdf:type ?undesiredClass.
    filter (?undesiredClass in (sh:PropertyShape, sh:Parameter, sh:NodeShape, sh:SPARQLRule, sh:SPARQLTarget, sh:SPARQLFunction, sh:SPARQLConstraint, rdfs:Class, rdfs:Datatype, rdf:Property, owl:Class, owl:DatatypeProperty, owl:ObjectProperty, owl:FunctionalProperty, owl:IrreflexiveProperty, owl:Restriction, owl:Ontology, owl:InverseFunctionalProperty, owl:InverseProperty, owl:AllDifferent, owl:AnnotationProperty, owl:NegativePropertyAssertion, owl:OntologyProperty, owl:AllDisjointClasses, owl:AllDisjointProperties, owl:Annotation,owl:AsymmetricProperty, owl:Axiom, owl:DataRange, owl:DeprecatedClass, owl:DeprecatedProperty, skos:Concept, skos:ConceptScheme, skos:Collection, respec:Generation))
    }
}
'''.

rule:Serialize_namedIndividual
  a sh:SPARQLRule;
  skos:prefLabel 'Named individuals rule'@en;
  rdfs:comment 'The named individuals rule serializes an named individual into Manchester Syntax.'@en ;
  sh:construct """

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> 

construct {
  # create the manchester syntax for the named individual to be serialized.
  $this manchester:syntax 'INDIVIDUAL';
        manchester:label ?manchesterLabel;
        manchester:class ?manchesterClass;
        manchester:fact ?manchesterFact.
} where {

  # Label of the named individual
  
  $this a ?class.
  bind(if(function:isIRI($this), concat("[=",function:getPrefixedIRI($this),"=]"), 'Anonymous individual') as ?manchesterLabel)
    
  # Class description   
  optional {?class manchester:label ?explicitClassName.}
  bind(coalesce(?explicitClassName, if(function:isIRI(?class), function:getPrefixedIRI(?class), 'Anonymous class')) as ?manchesterClass)
    
  # Fact description - datatype property
  optional
  {$this ?property ?literal.
   ?property rdf:type owl:DatatypeProperty;
              manchester:label ?propertyLabel.
  }
  # Fact description - object property
  optional
  {$this ?property ?object.
   ?property rdf:type owl:ObjectProperty;
              manchester:label ?propertyLabel.
  optional{?object manchester:label ?explicitObjectLabel.}
  bind(coalesce(?explicitObjectLabel, if(function:isIRI(?object), function:getPrefixedIRI(?object), 'Anonymous object')) as ?objectLabel)
  }
  bind(concat(function:getPrefixedIRI(?propertyLabel), " ", coalesce(str(?literal), ?objectLabel)) as ?manchesterFact)
}
  
""".

shp:Serializable_conceptScheme
    a sh:NodeShape;
    sh:rule rule:Serialize_conceptScheme;
    sh:target target:Serialize_conceptScheme;
    skos:prefLabel 'Serializable concept scheme shape.'@en.

target:Serialize_conceptScheme
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix respec: <https://respec.org/ontorespec/model/def/> 
prefix sh: <http://www.w3.org/ns/shacl#>
prefix skos: <http://www.w3.org/2004/02/skos/core#>

select $this {

  # A concept scheme
  
  $this rdf:type skos:ConceptScheme.   
  filter not exists {
    $this manchester:syntax 'CONCEPTSCHEME'
  }  
}
'''.

rule:Serialize_conceptScheme
  a sh:SPARQLRule;
  skos:prefLabel 'Concept scheme rule'@en;
  rdfs:comment 'The concept scheme rule serializes a concept scheme into Manchester Syntax.'@en ;
  sh:construct """

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> 

construct {
  # create the manchester syntax for the named individual to be serialized.
  $this manchester:syntax 'CONCEPTSCHEME';
        manchester:class 'Type: Concept Scheme';
        manchester:label ?manchesterLabel.

} where {

  # Label of the concept scheme
  bind(concat("[=",function:getPrefixedIRI($this),"=]") as ?manchesterLabel)
}

""".

shp:Serializable_concept
    a sh:NodeShape;
    sh:rule rule:Serialize_concept;
    sh:target target:Serialize_concept;
    skos:prefLabel 'Serializable concept shape.'@en.

target:Serialize_concept
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix respec: <https://respec.org/ontorespec/model/def/> 
prefix sh: <http://www.w3.org/ns/shacl#>
prefix skos: <http://www.w3.org/2004/02/skos/core#>

select $this {

  # A concept 
  
  $this rdf:type skos:Concept.   
  filter not exists {
    $this manchester:syntax 'CONCEPT'
  }  
}
'''.

rule:Serialize_concept
  a sh:SPARQLRule;
  skos:prefLabel 'Concept rule'@en;
  rdfs:comment 'The concept rule serializes a concept into Manchester Syntax.'@en ;
  sh:construct """

prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> 
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> 

construct {
  # create the manchester syntax for the named individual to be serialized.
  $this manchester:syntax 'CONCEPT';
        manchester:class 'Type: Concept';
        manchester:label ?manchesterLabel.

} where {

  # Label of the concept 
  bind(concat("[=",function:getPrefixedIRI($this),"=]") as ?manchesterLabel)
}

""".

shp:SerializableNodeShape
    a sh:NodeShape;
    sh:rule rule:SerializeNodeShape;
    sh:target target:SerializableNodeShape;
    skos:prefLabel 'Serializable NodeShape shape'@en.

  target:SerializableNodeShape
    a sh:SPARQLTarget;
    sh:select '''
prefix function:   <https://data.rijksfinancien.nl/manchester/model/function/>    
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl:        <http://www.w3.org/2002/07/owl#>
prefix rdf:        <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs:       <http://www.w3.org/2000/01/rdf-schema#>
prefix sh:         <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any node shape
  
  $this a sh:NodeShape.
  
  # The node shape must not have been processed yet.
  
  filter not exists {
   $this manchester:syntax 'NODESHAPE'
  }

  # The shacl artifacts connected to the node shape must have been processed already.
  
  filter not exists {
   $this sh:property ?propertyShape;
   filter not exists 
   {?propertyShape manchester:syntax 'PROPERTYSHAPE'}
  }
 
  filter not exists {
   $this sh:targetClass ?targetClass.
   filter(function:isBlank(?targetClass))
   filter not exists 
   {?targetClass manchester:label [].}
  }
  
  filter not exists {
    $this sh:targetClass ?targetClass.
    ?targetClass ?predicate [].
    filter(function:isIRI(?targetClass))
    filter not exists 
    {?targetClass manchester:label [].}
   }
    
  filter not exists {
    $this sh:target ?SPARQLTarget.
    filter not exists 
    {?sparqlTarget manchester:syntax 'SPARQLTARGET'.}
    }
    
  filter not exists {
    $this sh:rule ?SPARQLRule.
    filter not exists 
    {?rule manchester:syntax 'SPARQLRULE'}
    }    
}
  '''.

  rule:SerializeNodeShape
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a NodeShape.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a NodeShape'@en;
    sh:construct '''
prefix function:   <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf:        <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs:       <http://www.w3.org/2000/01/rdf-schema#>
prefix sh:         <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the NodeShape to be serialized.
  
  $this manchester:syntax 'NODESHAPE';
        manchester:label ?manchesterLabel;
        manchester:propertyShape ?propertyShapeLabel;
        manchester:targetNode ?manchesterTargetNode;
        manchester:targetClass ?manchesterTargetClass;
        manchester:targetSubjectsOf ?manchesterTargetSubjectsOf;
        manchester:targetObjectsOf ?manchesterTargetObjectsOf;
        manchester:targetSPARQL ?manchesterSPARQLTarget;
        manchester:rule ?manchesterRule.
} where {
  
  bind(if(function:isBlank($this), "Anonymous NodeShape",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
  
  optional{
  $this sh:property ?propertyShape.
  ?propertyShape manchester:label ?propertyShapeLabel.}
  
  optional{
  $this sh:targetNode ?targetNode.
  bind(function:getPrefixedIRI(?targetNode) as ?manchesterTargetNode)}
  
  optional {
  $this sh:targetClass ?targetClass.
  filter(function:isBlank(?targetClass))
  ?targetClass manchester:label ?manchesterTargetClass.
  }
  
  optional {
  $this sh:targetClass ?targetClass.
  filter(function:isIRI(?targetClass))
  filter not exists {
  ?targetClass ?anyPredicate []}
  bind(function:getPrefixedIRI(?targetClass) as ?manchesterTargetClass)
  }
  
  optional {
  $this sh:targetClass ?targetClass.
  ?targetClass manchester:label ?manchesterTargetClass.
  filter(function:isIRI(?targetClass))
  }
 
  optional {
  $this sh:targetSubjectsOf ?targetSubjectsOf.
  bind(function:getPrefixedIRI(?targetSubjectsOf) as ?manchesterTargetSubjectsOf)
  }
  
  optional
  {$this sh:targetObjectsOf ?targetObjectsOf.
  bind(function:getPrefixedIRI(?targetObjectsOf) as ?manchesterTargetObjectsOf)
  }
  
  optional
  {$this sh:target ?SPARQLTarget.
  ?SPARQLTarget manchester:label ?manchesterSPARQLTarget.
  }
  
  optional
  {$this sh:rule ?rule.
  ?rule manchester:label ?manchesterRule.
  }
}
'''.


shp:SerializablePropertyShape
    a sh:NodeShape;
    sh:rule rule:SerializePropertyShape;
    sh:target target:SerializablePropertyShape;
    skos:prefLabel 'Serializable PropertyShape shape'@en.

  target:SerializablePropertyShape
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any PropertyShape
  
  $this sh:path [].
  
  # ...but no SHACL parameter
  filter not exists { [] sh:parameter $this}
  filter not exists {$this rdf:type sh:Parameter}
  
  # The PropertyShape must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializePropertyShape
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a PropertyShape.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a PropertyShape'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the PropertyShape to be serialized.
  
  $this manchester:syntax 'PROPERTYSHAPE';
        manchester:label ?manchesterLabel.
} where {
  
  optional{
  $this sh:name ?propertyName.}
        
  bind(if(function:isBlank($this), coalesce(?propertyName, "Anonymous PropertyShape"),concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
} 

  '''.


shp:SerializableParameter
    a sh:NodeShape;
    sh:rule rule:SerializeParameter;
    sh:target target:SerializableParameter;
    skos:prefLabel 'Serializable Parameter shape'@en.

  target:SerializableParameter
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SHACL parameter
  
  {[] sh:parameter $this}
  UNION
  {$this rdf:type sh:Parameter}
  
  # The parameter must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:syntax 'PARAMETER'.
  }
}
  '''.

  rule:SerializeParameter
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SHACL parameter.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SHACL parameter'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the Parameter to be serialized.
  
  $this manchester:syntax 'PARAMETER';
        manchester:label ?manchesterLabel.
} where {
  
  optional{
  $this sh:name ?preferredParameterName.}

  $this sh:path ?pathParameter.
  bind(function:getPrefixedIRI(?pathParameter) as ?alternativeParameterName)  
  bind(if(function:isBlank($this), coalesce(?preferredParameterName, ?alternativeParameterName),concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
} 

  '''.

shp:SerializableSPARQLConstraint
    a sh:NodeShape;
    sh:rule rule:SerializeSPARQLConstraint;
    sh:target target:SerializableSPARQLConstraint;
    skos:prefLabel 'Serializable SPARQLConstraint shape'@en.

  target:SerializableSPARQLConstraint
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SPARQLConstraint
  
  $this rdf:type sh:SPARQLConstraint.
  
  # The SPARQLConstraint must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeSPARQLConstraint
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SPARQLConstraint.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SPARQLConstraint'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the SPARQLConstraint to be serialized.
  
  $this manchester:syntax 'SPARQLCONSTRAINT';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous SPARQLConstraint",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
} 

  '''.

shp:SerializableSPARQLFunction
    a sh:NodeShape;
    sh:rule rule:SerializeSPARQLFunction;
    sh:target target:SerializableSPARQLFunction;
    skos:prefLabel 'Serializable SPARQLFunction shape'@en.

  target:SerializableSPARQLFunction
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SPARQLFunction
  
  $this rdf:type sh:SPARQLFunction.
  
  # The SPARQLFunction must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
  
  # Any possible parameter of the SPARQL function should already have been processed
  filter not exists {
    $this sh:parameter ?parameter.
    filter not exists {
      ?parameter manchester:label []
   }
  }
}
  '''.

  rule:SerializeSPARQLFunction
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SPARQLFunction.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SPARQLFunction'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the SPARQLFunction to be serialized.
  
  $this manchester:syntax 'SPARQLFUNCTION';
        manchester:label ?manchesterLabel;
        manchester:parameter ?manchesterParameter.
} where {
  
  OPTIONAL{
  $this sh:parameter ?parameter.
  ?parameter manchester:label ?manchesterParameter.
  }
  
  bind(if(function:isBlank($this), "Anonymous SPARQLFunction",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
}   
'''.

shp:SerializableSPARQLRule
    a sh:NodeShape;
    sh:rule rule:SerializeSPARQLRule;
    sh:target target:SerializableSPARQLRule;
    skos:prefLabel 'Serializable SPARQLRule shape'@en.

  target:SerializableSPARQLRule
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SPARQLRule
  
  $this rdf:type sh:SPARQLRule.
  
  # The SPARQLRule must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeSPARQLRule
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SPARQLRule.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SPARQLRule'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the SPARQLRule to be serialized.
  
  $this manchester:syntax 'SPARQLRULE';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous SPARQLRule",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
}   
'''.

shp:SerializableTripleRule
    a sh:NodeShape;
    sh:rule rule:SerializeTripleRule;
    sh:target target:SerializableTripleRule;
    skos:prefLabel 'Serializable TripleRule shape'@en.

  target:SerializableTripleRule
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any TripleRule
  
  $this rdf:type sh:TripleRule.
  
  # The TripleRule must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeTripleRule
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a TripleRule.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a TripleRule'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the TripleRule to be serialized.
  
  $this manchester:syntax 'TRIPLERULE';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous TripleRule",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
}   
'''.

shp:SerializableSPARQLTarget
    a sh:NodeShape;
    sh:rule rule:SerializeSPARQLTarget;
    sh:target target:SerializableSPARQLTarget;
    skos:prefLabel 'Serializable SPARQLTarget shape'@en.

  target:SerializableSPARQLTarget
    a sh:SPARQLTarget;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SPARQLTarget
  
  $this rdf:type sh:SPARQLTarget.
  
  # The SPARQLTarget must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeSPARQLTarget
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SPARQLTarget.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SPARQLTarget'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the SPARQLTarget to be serialized.
  
  $this manchester:syntax 'SPARQLTARGET';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous SPARQLTarget",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
}   
'''.

shp:SerializableSPARQLTargetType
    a sh:NodeShape;
    sh:rule rule:SerializeSPARQLTargetType;
    sh:target target:SerializableSPARQLTargetType;
    skos:prefLabel 'Serializable SPARQLTargetType shape'@en.

  target:SerializableSPARQLTargetType
    a sh:SPARQLTargetType;
    sh:select '''
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix owl: <http://www.w3.org/2002/07/owl#>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

select $this {
  
  # Any SPARQLTargetType
  
  $this rdf:type sh:SPARQLTargetType.
  
  # The SPARQLTargetType must not have an Manchester Syntax string yet
  
  filter not exists {
    $this manchester:label [].
  }
}
  '''.

  rule:SerializeSPARQLTargetType
    a sh:SPARQLRule;
    rdfs:comment 'A rule that creates a manchester syntax label and definition for a SPARQLTargetType.'@en;
    skos:prefLabel 'Manchester Syntax serialisation rule for a SPARQLTargetType'@en;
    sh:construct '''
prefix function: <https://data.rijksfinancien.nl/manchester/model/function/>
prefix manchester: <https://data.rijksfinancien.nl/manchester/model/def/>
prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>
prefix sh: <http://www.w3.org/ns/shacl#>

construct {

  # create the manchester syntax for the SPARQLTargetType to be serialized.
  
  $this manchester:syntax 'SPARQLTARGETTYPE';
        manchester:label ?manchesterLabel.
} where {
  
  bind(if(function:isBlank($this), "Anonymous SPARQLTargetType",concat("[=",function:getPrefixedIRI($this),"=]")) as ?manchesterLabel)
 
}   
'''.

function:getPrefixedIRI
    a sh:SPARQLFunction ;
    rdfs:comment "Gets prefixed IRI from full IRI." ;
    skos:example '''Assume an ontology with namespace "http://example.org/", prefix "ex" and a class "Person" as defined by this ontology. The function call will result in "ex:Person" for the IRI http://example.org/Person''';
    sh:parameter [
        sh:path parameter:IRI ;
        sh:datatype xsd:anyURI ;
        sh:description "The full IRI of a RDF resource as defined in an ontology." ;
    ] ;
    sh:returnType xsd:string ;
    sh:select """

PREFIX manchester: <https://data.rijksfinancien.nl/manchester/model/def/> 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX sh: <http://www.w3.org/ns/shacl#>
PREFIX vann: <http://purl.org/vocab/vann/>

SELECT ?result WHERE {

  # Establish the default full IRI of the resource, e.g. ex:Person would lead to http://example.org/Person.
  bind(str($IRI) as ?fullIRI)

  # Establish possible namespaces through SHACL declarations
  optional
  {
    ?ontology sh:declare ?namespaceDeclaration.
    ?namespaceDeclaration sh:namespace ?namespace;
              # e.g. "http://example.org/"
              sh:prefix ?prefix.       # e.g. "ex"
    filter(strstarts(?fullIRI, str(?namespace))) # e.g. "http://example.org/"
  }
  
  # Establish possible namespaces through VANN declarations
  optional
  {
    ?ontology vann:preferredNamespaceUri ?namespace;
              # e.g. "http://example.org/"
              vann:preferredNamespacePrefix ?prefix.  # e.g. "ex"
    filter(strstarts(?fullIRI, str(?namespace))) # e.g. "http://example.org/"
  }

  # Establish possible namespaces through the Manchester Syntax ontology (generic ontologies like OWL, RDF, et cetera)
  optional 
    {
    manchester: sh:declare ?namespaceDeclaration.
    ?namespaceDeclaration sh:namespace ?namespace;
              # e.g. "http://example.org/"
              sh:prefix ?prefix.       # e.g. "ex"
    filter(strstarts(?fullIRI, str(?namespace))) # e.g. "http://example.org/"
  }

  # Establish the local name
  bind(strafter(?fullIRI, str(?namespace)) as ?localName)

  # Establish the prefixed IRI if prefix and localName exist, e.g. "ex:Person" or None
  bind(concat(str(?prefix),":",?localName) as ?prefixedIRI)

  # Establish result, either a prefixed IRI or the full IRI, e.g. "ex:Person" or "http://example.org/Person"
  bind(coalesce(?prefixedIRI, ?fullIRI) as ?result)
}
""" .

parameter:IRILike
    a sh:Parameter;
    sh:or list:IRILike;
    sh:order 1;
    sh:path parameter:IRI.
      
list:IRILike rdf:type rdf:List;
             rdf:first  [sh:class rdfs:Resource];
             rdf:rest list:URILike.

list:URILike rdf:type rdf:List;
             rdf:first [sh:datatype xsd:anyuri];
             rdf:rest  [rdf:first [sh:datatype xsd:string];
                        rdf:rest rdf:nil].

function:isBlank
    a sh:SPARQLFunction ;
    
    rdfs:comment "Returns a boolean indicating whether an IRI is a blank node or not. Normally this could be done using the SPARQL isBlank() function. However, some triple stores use the 'well-known IRI' concept and then that function does not work well, despite such an IRI originating from a blank node." ;
   
    sh:parameter [
        sh:path parameter:IRILike ;
        sh:datatype xsd:anyURI ;
        sh:description "An IRI-like pattern." ;
    ] ;
    sh:returnType xsd:boolean ;
    sh:select """

prefix function:   <https://data.rijksfinancien.nl/manchester/model/function/>

select $result

{
# Pseudo-logic:
# If the resource is a blank node, return true;
# Else if it is not a blank node, but a well-known IRI then return true;
# Else return false as the resource must be a real IRI.

bind(if(isBlank($IRILike), true, contains(str($IRILike), '/.well-known/genid/')) as $result)
}

""" .

function:isIRI
    a sh:SPARQLFunction ;
    
    rdfs:comment "Returns a boolean indicating whether an IRI is an IRI or not. Normally this could be done using the SPARQL isIRI() function. However, some triple stores use the 'well-known IRI' concept for a blank node and then that function does not work well, despite such an IRI originating from a blank node." ;
   
    sh:parameter [
        sh:path parameter:IRILike ;
        sh:datatype xsd:anyURI ;
        sh:description "An IRI-like pattern." ;
    ] ;
    sh:returnType xsd:boolean ;
    sh:select """

select $result

{
# Pseudo-logic:
# If the resource is a blank node, return false;
# Else if it is not a blank node, but a well-known IRI then return false;
# Else return true as the resource must be a real IRI.

bind(if(isBlank($IRILike), false, !contains(str($IRILike), '/.well-known/genid/')) as ?result)
}

""" .
}
